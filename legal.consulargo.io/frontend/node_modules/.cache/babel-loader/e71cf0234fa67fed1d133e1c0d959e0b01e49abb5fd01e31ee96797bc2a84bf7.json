{"ast":null,"code":"import React,{useState}from'react';import{Form,Input,Button,Card,message,Space}from'antd';import{LockOutlined}from'@ant-design/icons';import{useAuth}from'../contexts/AuthContext';import{authService}from'../services/authService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Settings=()=>{const[loading,setLoading]=useState(false);const[form]=Form.useForm();const{user}=useAuth();const onFinish=async values=>{setLoading(true);try{await authService.changePassword(values.currentPassword,values.newPassword);message.success('密码修改成功！');form.resetFields();}catch(error){var _error$response,_error$response$data;message.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'密码修改失败');}finally{setLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{style:{marginBottom:'24px'},children:\"\\u8BBE\\u7F6E\"}),/*#__PURE__*/_jsx(Card,{title:\"\\u4FEE\\u6539\\u5BC6\\u7801\",style:{maxWidth:500},children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:onFinish,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"currentPassword\",label:\"\\u5F53\\u524D\\u5BC6\\u7801\",rules:[{required:true,message:'请输入当前密码'}],children:/*#__PURE__*/_jsx(Input.Password,{prefix:/*#__PURE__*/_jsx(LockOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u5F53\\u524D\\u5BC6\\u7801\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"newPassword\",label:\"\\u65B0\\u5BC6\\u7801\",rules:[{required:true,message:'请输入新密码'},{min:6,message:'密码长度至少6位'}],children:/*#__PURE__*/_jsx(Input.Password,{prefix:/*#__PURE__*/_jsx(LockOutlined,{}),placeholder:\"\\u8BF7\\u8F93\\u5165\\u65B0\\u5BC6\\u7801\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"confirmPassword\",label:\"\\u786E\\u8BA4\\u65B0\\u5BC6\\u7801\",dependencies:['newPassword'],rules:[{required:true,message:'请确认新密码'},_ref=>{let{getFieldValue}=_ref;return{validator(_,value){if(!value||getFieldValue('newPassword')===value){return Promise.resolve();}return Promise.reject(new Error('两次输入的密码不一致'));}};}],children:/*#__PURE__*/_jsx(Input.Password,{prefix:/*#__PURE__*/_jsx(LockOutlined,{}),placeholder:\"\\u8BF7\\u518D\\u6B21\\u8F93\\u5165\\u65B0\\u5BC6\\u7801\"})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loading,children:\"\\u4FEE\\u6539\\u5BC6\\u7801\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>form.resetFields(),children:\"\\u91CD\\u7F6E\"})]})})]})}),/*#__PURE__*/_jsx(Card,{title:\"\\u8D26\\u6237\\u4FE1\\u606F\",style:{maxWidth:500,marginTop:'24px'},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u7528\\u6237\\u540D\\uFF1A\"}),user===null||user===void 0?void 0:user.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u90AE\\u7BB1\\uFF1A\"}),(user===null||user===void 0?void 0:user.email)||'未设置']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u89D2\\u8272\\uFF1A\"}),(user===null||user===void 0?void 0:user.role)==='admin'?'管理员':'用户']})]})})]});};export default Settings;","map":{"version":3,"names":["React","useState","Form","Input","Button","Card","message","Space","LockOutlined","useAuth","authService","jsx","_jsx","jsxs","_jsxs","Settings","loading","setLoading","form","useForm","user","onFinish","values","changePassword","currentPassword","newPassword","success","resetFields","error","_error$response","_error$response$data","response","data","children","style","marginBottom","title","maxWidth","layout","Item","name","label","rules","required","Password","prefix","placeholder","min","dependencies","_ref","getFieldValue","validator","_","value","Promise","resolve","reject","Error","type","htmlType","onClick","marginTop","username","email","role"],"sources":["/Users/jayt/Desktop/legal.consulargo.io/legal-admin-system/legal.consulargo.io/frontend/src/pages/Settings.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Form, Input, Button, Card, message, Space } from 'antd';\nimport { LockOutlined } from '@ant-design/icons';\nimport { useAuth } from '../contexts/AuthContext';\nimport { authService } from '../services/authService';\n\nconst Settings: React.FC = () => {\n  const [loading, setLoading] = useState(false);\n  const [form] = Form.useForm();\n  const { user } = useAuth();\n\n  const onFinish = async (values: any) => {\n    setLoading(true);\n    try {\n      await authService.changePassword(values.currentPassword, values.newPassword);\n      message.success('密码修改成功！');\n      form.resetFields();\n    } catch (error: any) {\n      message.error(error.response?.data?.error || '密码修改失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div>\n      <h1 style={{ marginBottom: '24px' }}>设置</h1>\n        \n        <Card title=\"修改密码\" style={{ maxWidth: 500 }}>\n          <Form\n            form={form}\n            layout=\"vertical\"\n            onFinish={onFinish}\n          >\n            <Form.Item\n              name=\"currentPassword\"\n              label=\"当前密码\"\n              rules={[{ required: true, message: '请输入当前密码' }]}\n            >\n              <Input.Password \n                prefix={<LockOutlined />}\n                placeholder=\"请输入当前密码\"\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"newPassword\"\n              label=\"新密码\"\n              rules={[\n                { required: true, message: '请输入新密码' },\n                { min: 6, message: '密码长度至少6位' }\n              ]}\n            >\n              <Input.Password \n                prefix={<LockOutlined />}\n                placeholder=\"请输入新密码\"\n              />\n            </Form.Item>\n\n            <Form.Item\n              name=\"confirmPassword\"\n              label=\"确认新密码\"\n              dependencies={['newPassword']}\n              rules={[\n                { required: true, message: '请确认新密码' },\n                ({ getFieldValue }) => ({\n                  validator(_, value) {\n                    if (!value || getFieldValue('newPassword') === value) {\n                      return Promise.resolve();\n                    }\n                    return Promise.reject(new Error('两次输入的密码不一致'));\n                  },\n                }),\n              ]}\n            >\n              <Input.Password \n                prefix={<LockOutlined />}\n                placeholder=\"请再次输入新密码\"\n              />\n            </Form.Item>\n\n            <Form.Item>\n              <Space>\n                <Button\n                  type=\"primary\"\n                  htmlType=\"submit\"\n                  loading={loading}\n                >\n                  修改密码\n                </Button>\n                <Button onClick={() => form.resetFields()}>\n                  重置\n                </Button>\n              </Space>\n            </Form.Item>\n          </Form>\n        </Card>\n\n        <Card title=\"账户信息\" style={{ maxWidth: 500, marginTop: '24px' }}>\n          <div>\n            <p><strong>用户名：</strong>{user?.username}</p>\n            <p><strong>邮箱：</strong>{user?.email || '未设置'}</p>\n            <p><strong>角色：</strong>{user?.role === 'admin' ? '管理员' : '用户'}</p>\n          </div>\n        </Card>\n      </div>\n  );\n};\n\nexport default Settings;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}