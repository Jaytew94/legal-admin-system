{"ast":null,"code":"import _objectSpread from\"/Users/jayt/Desktop/legal.consulargo.io/legal-admin-system/legal.consulargo.io/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Form,Input,DatePicker,Button,Card,message,Space,Select,Spin}from'antd';import{SaveOutlined,ArrowLeftOutlined}from'@ant-design/icons';import{useNavigate,useParams}from'react-router-dom';import{recordService}from'../services/recordService';import dayjs from'dayjs';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Option}=Select;const EditRecord=()=>{const[loading,setLoading]=useState(false);const[initialLoading,setInitialLoading]=useState(true);const[form]=Form.useForm();const navigate=useNavigate();const{id}=useParams();useEffect(()=>{if(id){loadRecord(parseInt(id));}},[id]);const loadRecord=async recordId=>{try{const response=await recordService.getRecord(recordId);const record=response.record;form.setFieldsValue(_objectSpread(_objectSpread({},record),{},{issue_date:dayjs(record.issue_date)}));}catch(error){message.error('加载记录失败');navigate('/records');}finally{setInitialLoading(false);}};const onFinish=async values=>{if(!id)return;setLoading(true);try{const recordData=_objectSpread(_objectSpread({},values),{},{issue_date:values.issue_date.format('YYYY-MM-DD')});await recordService.updateRecord(parseInt(id),recordData);message.success('记录更新成功！');navigate('/records');}catch(error){var _error$response,_error$response$data;message.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'更新记录失败');}finally{setLoading(false);}};if(initialLoading){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'50px'},children:/*#__PURE__*/_jsx(Spin,{size:\"large\"})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:16},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(ArrowLeftOutlined,{}),onClick:()=>navigate('/records'),children:\"\\u8FD4\\u56DE\"}),/*#__PURE__*/_jsx(\"h1\",{style:{margin:0},children:\"\\u7F16\\u8F91\\u8BB0\\u5F55\"})]})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:onFinish,children:[/*#__PURE__*/_jsx(Form.Item,{name:\"legalization_no\",label:\"\\u6CD5\\u5F8B\\u7F16\\u53F7\",rules:[{required:true,message:'请输入法律编号'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u4F8B\\u5982: SKAKP5V-001\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"issue_date\",label:\"\\u53D1\\u5E03\\u65E5\\u671F\",rules:[{required:true,message:'请选择发布日期'}],children:/*#__PURE__*/_jsx(DatePicker,{style:{width:'100%'}})}),/*#__PURE__*/_jsx(Form.Item,{name:\"place_of_issue\",label:\"\\u53D1\\u5E03\\u5730\\u70B9\",children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u4F8B\\u5982: SKA\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"legalization_type\",label:\"\\u8BA4\\u8BC1\\u7C7B\\u578B\",rules:[{required:true,message:'请输入认证类型'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u4F8B\\u5982: SEEN AT THE MINISTRY OF FOREIGN AFFAIRS\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"authorized_officer\",label:\"\\u6388\\u6743\\u5B98\\u5458\",rules:[{required:true,message:'请输入授权官员姓名'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u4F8B\\u5982: MISS SAMARIN SIRISAWAT\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"document_owner\",label:\"\\u6587\\u6863\\u6240\\u6709\\u8005\",rules:[{required:true,message:'请输入文档所有者姓名'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u4F8B\\u5982: MISS UNYANEE KHAOWISET\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"document_type\",label:\"\\u6587\\u6863\\u7C7B\\u578B\",rules:[{required:true,message:'请输入文档类型'}],children:/*#__PURE__*/_jsx(Input,{placeholder:\"\\u4F8B\\u5982: CERTIFICATE OF BIRTH\"})}),/*#__PURE__*/_jsx(Form.Item,{name:\"status\",label:\"\\u72B6\\u6001\",rules:[{required:true,message:'请选择状态'}],children:/*#__PURE__*/_jsxs(Select,{children:[/*#__PURE__*/_jsx(Option,{value:\"active\",children:\"\\u6D3B\\u8DC3\"}),/*#__PURE__*/_jsx(Option,{value:\"inactive\",children:\"\\u9690\\u85CF\"})]})}),/*#__PURE__*/_jsx(Form.Item,{children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:loading,icon:/*#__PURE__*/_jsx(SaveOutlined,{}),children:\"\\u4FDD\\u5B58\\u66F4\\u6539\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>navigate('/records'),children:\"\\u53D6\\u6D88\"})]})})]})})]});};export default EditRecord;","map":{"version":3,"names":["React","useState","useEffect","Form","Input","DatePicker","Button","Card","message","Space","Select","Spin","SaveOutlined","ArrowLeftOutlined","useNavigate","useParams","recordService","dayjs","jsx","_jsx","jsxs","_jsxs","Option","EditRecord","loading","setLoading","initialLoading","setInitialLoading","form","useForm","navigate","id","loadRecord","parseInt","recordId","response","getRecord","record","setFieldsValue","_objectSpread","issue_date","error","onFinish","values","recordData","format","updateRecord","success","_error$response","_error$response$data","data","style","textAlign","padding","children","size","marginBottom","icon","onClick","margin","layout","Item","name","label","rules","required","placeholder","width","value","type","htmlType"],"sources":["/Users/jayt/Desktop/legal.consulargo.io/legal-admin-system/legal.consulargo.io/frontend/src/pages/EditRecord.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Form, Input, DatePicker, Button, Card, message, Space, Select, Spin } from 'antd';\nimport { SaveOutlined, ArrowLeftOutlined } from '@ant-design/icons';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { recordService } from '../services/recordService';\n\nimport dayjs from 'dayjs';\n\nconst { Option } = Select;\n\nconst EditRecord: React.FC = () => {\n  const [loading, setLoading] = useState(false);\n  const [initialLoading, setInitialLoading] = useState(true);\n  const [form] = Form.useForm();\n  const navigate = useNavigate();\n  const { id } = useParams<{ id: string }>();\n\n  useEffect(() => {\n    if (id) {\n      loadRecord(parseInt(id));\n    }\n  }, [id]);\n\n  const loadRecord = async (recordId: number) => {\n    try {\n      const response = await recordService.getRecord(recordId);\n      const record = response.record;\n      \n      form.setFieldsValue({\n        ...record,\n        issue_date: dayjs(record.issue_date),\n      });\n    } catch (error) {\n      message.error('加载记录失败');\n      navigate('/records');\n    } finally {\n      setInitialLoading(false);\n    }\n  };\n\n  const onFinish = async (values: any) => {\n    if (!id) return;\n    \n    setLoading(true);\n    try {\n      const recordData = {\n        ...values,\n        issue_date: values.issue_date.format('YYYY-MM-DD'),\n      };\n\n      await recordService.updateRecord(parseInt(id), recordData);\n      message.success('记录更新成功！');\n      navigate('/records');\n    } catch (error: any) {\n      message.error(error.response?.data?.error || '更新记录失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (initialLoading) {\n    return (\n      <div style={{ textAlign: 'center', padding: '50px' }}>\n        <Spin size=\"large\" />\n      </div>\n    );\n  }\n\n  return (\n    <div>\n        <div style={{ marginBottom: 16 }}>\n          <Space>\n            <Button \n              icon={<ArrowLeftOutlined />} \n              onClick={() => navigate('/records')}\n            >\n              返回\n            </Button>\n            <h1 style={{ margin: 0 }}>编辑记录</h1>\n          </Space>\n        </div>\n\n        <Card>\n          <Form\n            form={form}\n            layout=\"vertical\"\n            onFinish={onFinish}\n          >\n            <Form.Item\n              name=\"legalization_no\"\n              label=\"法律编号\"\n              rules={[{ required: true, message: '请输入法律编号' }]}\n            >\n              <Input placeholder=\"例如: SKAKP5V-001\" />\n            </Form.Item>\n\n            <Form.Item\n              name=\"issue_date\"\n              label=\"发布日期\"\n              rules={[{ required: true, message: '请选择发布日期' }]}\n            >\n              <DatePicker style={{ width: '100%' }} />\n            </Form.Item>\n\n            <Form.Item\n              name=\"place_of_issue\"\n              label=\"发布地点\"\n            >\n              <Input placeholder=\"例如: SKA\" />\n            </Form.Item>\n\n            <Form.Item\n              name=\"legalization_type\"\n              label=\"认证类型\"\n              rules={[{ required: true, message: '请输入认证类型' }]}\n            >\n              <Input placeholder=\"例如: SEEN AT THE MINISTRY OF FOREIGN AFFAIRS\" />\n            </Form.Item>\n\n            <Form.Item\n              name=\"authorized_officer\"\n              label=\"授权官员\"\n              rules={[{ required: true, message: '请输入授权官员姓名' }]}\n            >\n              <Input placeholder=\"例如: MISS SAMARIN SIRISAWAT\" />\n            </Form.Item>\n\n            <Form.Item\n              name=\"document_owner\"\n              label=\"文档所有者\"\n              rules={[{ required: true, message: '请输入文档所有者姓名' }]}\n            >\n              <Input placeholder=\"例如: MISS UNYANEE KHAOWISET\" />\n            </Form.Item>\n\n            <Form.Item\n              name=\"document_type\"\n              label=\"文档类型\"\n              rules={[{ required: true, message: '请输入文档类型' }]}\n            >\n              <Input placeholder=\"例如: CERTIFICATE OF BIRTH\" />\n            </Form.Item>\n\n            <Form.Item\n              name=\"status\"\n              label=\"状态\"\n              rules={[{ required: true, message: '请选择状态' }]}\n            >\n              <Select>\n                <Option value=\"active\">活跃</Option>\n                <Option value=\"inactive\">隐藏</Option>\n              </Select>\n            </Form.Item>\n\n            <Form.Item>\n              <Space>\n                <Button\n                  type=\"primary\"\n                  htmlType=\"submit\"\n                  loading={loading}\n                  icon={<SaveOutlined />}\n                >\n                  保存更改\n                </Button>\n                <Button onClick={() => navigate('/records')}>\n                  取消\n                </Button>\n              </Space>\n            </Form.Item>\n          </Form>\n        </Card>\n      </div>\n  );\n};\n\nexport default EditRecord;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}