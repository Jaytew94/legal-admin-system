{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useSearchParams}from'react-router-dom';import{Card,Descriptions,Spin,Alert,Typography}from'antd';import{QrcodeOutlined}from'@ant-design/icons';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Title}=Typography;const VerificationPage=()=>{const[searchParams]=useSearchParams();const[record,setRecord]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const qrCode=searchParams.get('qr');const fetchRecord=useCallback(async()=>{try{const response=await fetch(\"\".concat(window.location.origin,\"/api/qrcode/info/\").concat(qrCode));if(response.ok){const data=await response.json();setRecord(data);}else{setError('记录不存在或已失效');}}catch(error){console.error('获取记录失败:',error);setError('获取记录失败，请稍后重试');}finally{setLoading(false);}},[qrCode]);useEffect(()=>{if(!qrCode){setError('缺少QR码参数');setLoading(false);return;}fetchRecord();},[qrCode,fetchRecord]);if(loading){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh'},children:/*#__PURE__*/_jsx(Spin,{size:\"large\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh'},children:/*#__PURE__*/_jsx(Alert,{message:\"\\u9A8C\\u8BC1\\u5931\\u8D25\",description:error,type:\"error\",showIcon:true,style:{maxWidth:500}})});}if(!record){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',minHeight:'100vh'},children:/*#__PURE__*/_jsx(Alert,{message:\"\\u8BB0\\u5F55\\u4E0D\\u5B58\\u5728\",description:\"\\u672A\\u627E\\u5230\\u5BF9\\u5E94\\u7684\\u6CD5\\u5F8B\\u8BA4\\u8BC1\\u8BB0\\u5F55\",type:\"warning\",showIcon:true,style:{maxWidth:500}})});}return/*#__PURE__*/_jsx(\"div\",{style:{padding:'20px',maxWidth:'800px',margin:'0 auto',minHeight:'100vh',backgroundColor:'#f5f5f5'},children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',marginBottom:'24px'},children:[/*#__PURE__*/_jsx(QrcodeOutlined,{style:{fontSize:'48px',color:'#1890ff',marginBottom:'16px'}}),/*#__PURE__*/_jsx(Title,{level:2,style:{margin:0},children:\"\\u6CD5\\u5F8B\\u8BA4\\u8BC1\\u8BB0\\u5F55\\u9A8C\\u8BC1\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'#666',margin:'8px 0 0 0'},children:\"\\u6B64\\u8BB0\\u5F55\\u5DF2\\u901A\\u8FC7\\u5B98\\u65B9\\u9A8C\\u8BC1\"})]}),/*#__PURE__*/_jsxs(Descriptions,{title:\"\\u8BB0\\u5F55\\u8BE6\\u60C5\",bordered:true,column:1,size:\"middle\",labelStyle:{fontWeight:'bold',width:'200px'},children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u8BA4\\u8BC1\\u7F16\\u53F7\",children:record.legalization_no}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u7B7E\\u53D1\\u65E5\\u671F\",children:new Date(record.date_of_issue).toLocaleDateString('zh-CN')}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u7B7E\\u53D1\\u5730\\u70B9\",children:record.place_of_issue}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u8BA4\\u8BC1\\u7C7B\\u578B\",children:record.type_of_legalization}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u6388\\u6743\\u5B98\\u5458\",children:record.authorized_officer}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u6587\\u6863\\u6240\\u6709\\u8005\",children:record.document_owner}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u6587\\u6863\\u7C7B\\u578B\",children:record.type_of_document}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u9A8C\\u8BC1\\u7801\",children:/*#__PURE__*/_jsx(\"code\",{style:{backgroundColor:'#f0f0f0',padding:'4px 8px',borderRadius:'4px'},children:record.qr_code})})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'24px',padding:'16px',backgroundColor:'#f6ffed',border:'1px solid #b7eb8f',borderRadius:'6px',textAlign:'center'},children:/*#__PURE__*/_jsx(\"p\",{style:{margin:0,color:'#52c41a',fontWeight:'bold'},children:\"\\u2705 \\u6B64\\u8BB0\\u5F55\\u5DF2\\u901A\\u8FC7\\u5B98\\u65B9\\u9A8C\\u8BC1\\uFF0C\\u771F\\u5B9E\\u6709\\u6548\"})})]})});};export default VerificationPage;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useSearchParams","Card","Descriptions","Spin","Alert","Typography","QrcodeOutlined","jsx","_jsx","jsxs","_jsxs","Title","VerificationPage","searchParams","record","setRecord","loading","setLoading","error","setError","qrCode","get","fetchRecord","response","fetch","concat","window","location","origin","ok","data","json","console","style","display","justifyContent","alignItems","minHeight","children","size","message","description","type","showIcon","maxWidth","padding","margin","backgroundColor","textAlign","marginBottom","fontSize","color","level","title","bordered","column","labelStyle","fontWeight","width","Item","label","legalization_no","Date","date_of_issue","toLocaleDateString","place_of_issue","type_of_legalization","authorized_officer","document_owner","type_of_document","borderRadius","qr_code","marginTop","border"],"sources":["/Users/jayt/Desktop/legal.consulargo.io/legal-admin-system/legal.consulargo.io/frontend/src/pages/VerificationPage.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { Card, Descriptions, Spin, Alert, Typography } from 'antd';\nimport { QrcodeOutlined } from '@ant-design/icons';\n\nconst { Title } = Typography;\n\ninterface LegalizationRecord {\n  id: number;\n  legalization_no: string;\n  date_of_issue: string;\n  place_of_issue: string;\n  type_of_legalization: string;\n  authorized_officer: string;\n  document_owner: string;\n  type_of_document: string;\n  qr_code: string;\n  created_at: string;\n}\n\nconst VerificationPage: React.FC = () => {\n  const [searchParams] = useSearchParams();\n  const [record, setRecord] = useState<LegalizationRecord | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const qrCode = searchParams.get('qr');\n\n  const fetchRecord = useCallback(async () => {\n    try {\n      const response = await fetch(`${window.location.origin}/api/qrcode/info/${qrCode}`);\n      \n      if (response.ok) {\n        const data = await response.json();\n        setRecord(data);\n      } else {\n        setError('记录不存在或已失效');\n      }\n    } catch (error) {\n      console.error('获取记录失败:', error);\n      setError('获取记录失败，请稍后重试');\n    } finally {\n      setLoading(false);\n    }\n  }, [qrCode]);\n\n  useEffect(() => {\n    if (!qrCode) {\n      setError('缺少QR码参数');\n      setLoading(false);\n      return;\n    }\n\n    fetchRecord();\n  }, [qrCode, fetchRecord]);\n\n  if (loading) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        minHeight: '100vh' \n      }}>\n        <Spin size=\"large\" />\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        minHeight: '100vh' \n      }}>\n        <Alert\n          message=\"验证失败\"\n          description={error}\n          type=\"error\"\n          showIcon\n          style={{ maxWidth: 500 }}\n        />\n      </div>\n    );\n  }\n\n  if (!record) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        minHeight: '100vh' \n      }}>\n        <Alert\n          message=\"记录不存在\"\n          description=\"未找到对应的法律认证记录\"\n          type=\"warning\"\n          showIcon\n          style={{ maxWidth: 500 }}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ \n      padding: '20px', \n      maxWidth: '800px', \n      margin: '0 auto',\n      minHeight: '100vh',\n      backgroundColor: '#f5f5f5'\n    }}>\n      <Card>\n        <div style={{ textAlign: 'center', marginBottom: '24px' }}>\n          <QrcodeOutlined style={{ fontSize: '48px', color: '#1890ff', marginBottom: '16px' }} />\n          <Title level={2} style={{ margin: 0 }}>法律认证记录验证</Title>\n          <p style={{ color: '#666', margin: '8px 0 0 0' }}>\n            此记录已通过官方验证\n          </p>\n        </div>\n\n        <Descriptions\n          title=\"记录详情\"\n          bordered\n          column={1}\n          size=\"middle\"\n          labelStyle={{ fontWeight: 'bold', width: '200px' }}\n        >\n          <Descriptions.Item label=\"认证编号\">\n            {record.legalization_no}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"签发日期\">\n            {new Date(record.date_of_issue).toLocaleDateString('zh-CN')}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"签发地点\">\n            {record.place_of_issue}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"认证类型\">\n            {record.type_of_legalization}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"授权官员\">\n            {record.authorized_officer}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"文档所有者\">\n            {record.document_owner}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"文档类型\">\n            {record.type_of_document}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"验证码\">\n            <code style={{ backgroundColor: '#f0f0f0', padding: '4px 8px', borderRadius: '4px' }}>\n              {record.qr_code}\n            </code>\n          </Descriptions.Item>\n        </Descriptions>\n\n        <div style={{ \n          marginTop: '24px', \n          padding: '16px', \n          backgroundColor: '#f6ffed', \n          border: '1px solid #b7eb8f',\n          borderRadius: '6px',\n          textAlign: 'center'\n        }}>\n          <p style={{ margin: 0, color: '#52c41a', fontWeight: 'bold' }}>\n            ✅ 此记录已通过官方验证，真实有效\n          </p>\n        </div>\n      </Card>\n    </div>\n  );\n};\n\nexport default VerificationPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}